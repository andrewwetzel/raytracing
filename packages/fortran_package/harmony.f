SUBROUTINE HARMON y
MODEL OF THE EARTH S MAGNETIC FIELD BASED ON A HARMONIC ANALYSIS

HARMODl
HARM002

DIMENSION PHPTH(7,7J ,PGPTH(7,7) ,A1(7,7) ,81(7,7)
HARMOD)
DIMENSJON H17,7) ,G17,71 ,GG(7.71 .HH(7,7),SINP(7),caSP(7)
HARM004
COMMO~ IYY/ MODy,y,PYPR,PYPTH,PYPPH,yR,PYRPR,PYRPT,PYRPP,YTH,PYTPRHARM005

HARM006

1,PYTPT ,PYTPP ,YPH,PYPPR,PYPPT,PYPPP
Cm·1MON R(6)

C

/~"WI

IDCIO),WQ,WI400 1

HARMOD7

COMMON ICONSTI PI,PIT2,PID2.DUM(SI

HARMOOe

EOUIVA L ENCE
EQUIVALENCE

HARM009
HARMOIO

(THETA,RI21) ,(PHI,RI3' )
IEARTHR,WI2J ),IF,W(6)) ,IREADFH.WI200IJ

RAT IQ OF CHARGE 10 MASS FOR FLECT~ ON
DATAIEOM = 1.7589E7)
DATA (5E1=0.) ,iH=1.,48(O.», (G =49(O.»
1 ,(P GPTh =49(O.» tCMOJY=7HHARMONY)
ENTRY MAGY
IFISET) GO TO 2
DO 1 M=1,7
DO 1 N=1,7
BICM,NI=(N+M - ll·(N - M+11/C2*N-1.1
AICM,Nl=81CM,N1/C2*N+11
SET=,.

147

,(PHPTH=49(O.»

HARMOll
HARM012
HARM013
HARM014
HARM015
HARM016
HARM017
HARM018
HARM019
HARM020
HARM021

2 IF(READFH.EQ.O.) GO TO 3

HARM022

READ 20QQ,GG.HH
2000 FORMAT(lX,F9.4,6FIO.4)

KARM023
HARM024

PRINT 210Q,GG
HARM025
2100 FORMAT(lHl,lOX,lHQ,14X,lHl,14X,lH2,14X,lH3,14X.lH4.14X,lH5.14X,lH6HARM026
1/9X,7(lHG,14XI/IOX,7 1 1HN'14XI//(lX,7F15.6))
HARM027
PRINT 220Q,HH
HARM028

2200 FeRMAT(// llX,lHQ,14X,lHl,14X,lH2.14X,lH3,14X,lH4,14X.IHS.14X.IH6HARM029
1 19X,7(IHH,14X)/lOX,7(lHN,14XII/(lX,7F15.6))
HARM030
3

4

5

6

READFH=O.
COSTHE=COS(THETA)
SINTHE=SIN(THETA)
AOR=EARTHR/R(lJ
PAORPR= - AOR/R(I)
CNST2=AOR
PCNSPR=PAORPR
FINI=PFINIR=PFINIT=PFINIP=O.
FIN2=PFIN2R=PFIN2T=PFIN2P=O.

HARM031
HARM032
HARM033
HARM034
HARM035
HARM036
HARM037
HARMD38
HARM039

FIN3=PFIN3R=PFIN3T=PFIN3P=O.
DO 4 M=1,7
SINP{MI=SIN{(M-!I*PHII
COSP(M)=CQS((M-!I*PHIJ

HARM040
HARM041

HIl.2i=COSTHE

HARM044

H(2,2)=SINTHE
DO 5 M=1,5

HARM045
HARM046

H(M+l'~+2J=COSTHE*H(M+l,M+ll

HARM047
HARM048
HARM049
HARM050
HARM05l
HARM052
HARMO 53
HARM054
HARM055
HARM056
HARM057

HARM042
HARM043

H(M+2,M+21=SINTHE*H(M+l,M+ll
DO 5 N=~,5
H(M,N+2 1=COSTHE*H(M,N+II-Al(M,NI*H(M,NI
DO 6 M=1,6
G(,101+1 ,M+l J =-M*COSTHE*H(M+l ,r~+l I
PHPT H (M+ 1,,"'1+ 1 I =-G U-1+ 1 ,M+ 1) IS r NTHE
PGPTH (M+ 1 ,M+ 1) =M*S I NTHE*H (M+ 1 ,M+ 1) -M*COSTHE*PHPTH (tof+ 1 ,M+l)
DO 6 N=M,6
G(M,N+ll=-N*C05THE*H(M,N+ll+81(M,N'*H(M,NJ
PHPTHIM,N+IJ:-G(M,N+11/5INTHE

PGPTH(M,N~lJ=N*5INTHE*H(~,N+l)-N*COSTHE*PHPTH(M,N+l)+Rl(M,Nl*PHPTHHARM058

1 (M,NI
DO 8 N=1,7
CR=PCRPTH =PCRPPH= O.
CTH=PCTHPT=PCTHPP=O.
CPH=PCPtiPT=PCPHPP=O.
DO 7 M=l,N
TEMPl=GG(M,Nl*COSP(M'+HH(M,NI*5INP(MI
TEMP2= (M-l) * (HH (M ,N I *casp (MI -GG (M ,N) *5 TNP (HI)
CR
=CR
+H(~,Nl*TEMPl
PCRPTH=PCRPTH+PHPTH(M,Nl*TEMPl
PCRPPH=PCRPPH+H(~,~I*TEHP2

CTH
=CTH
+G(M,NJ*TEMPI
PCTHPT=PCTHPT+PGPTH(M,Nl*TEMPl
PCTHPP=PCTHPP+G(M,NI*TEMP2
CPH
=CPH
+H(M,NI*TEMP2
PCPHPT=PCPHPT+PHPTHIM,N'*TEMP2
7

PCPHPP=P,CPHPP-H(M,N)*(M-IJ**2*T~MPl
CNST2=(~IST2*AOR

PCNSPR=CNST2*PAORPR+AOR*PCNSPR
FINl=FTNl+N*CNST2*CR
PFINIR=PFINIR+N*PCNSPR*CR
PFINlT=PFINIT+N*CNST2*PCRPTH
PF r N IP=PF I·N lP+N*CNS T 2*PCRPPH
FIN2=FIN2+CNST2*CTH
PFIN2R=PFIN2R+PCNSPR*CTH
PFIN2T=PFIN2T+CNST2*PCTHPT
PFIN2P=PFIN2P+CNST2*PCTHPP
FIN3=FIN3+CNST2*CPH

148

HARM()59
HARM060
HARM061
HARM062
HARM063
HARM064
HARM065
HARM066
HARM067
HARM068
HARM069
HARM070
HARM07l
HARM072
HARM073
HARM074
HARM075
HARM076
HARM077
HARM078
HARM079
HARM080
HARM081
HARM082
HARM083
HARM084
HARM085
HARM086

P FI N3 R=PF IN3 iH PCNSPR"'CPH

a

HARM087

P FINH= PF INH +CNST2 "PCPHPT

HAR M066

PFIN3P=PFIN3P"CNSTZ·PCPHP::>

HARt10a9

~THETA=-FIN2/SINTHE

HARHOgO
HARMOg1

HPHI=FIN3/SINTHF.
C~·~·····'"

CONvERT FROM MAG FIELQ IN G4USS

TO GYROFREQ IN H~Z

HARH09Z

:ONST=-EOH/PIT2"t . E-6/F
YR=-CONST"FINt

HARHOg3

YTH=CONST'HT~ETA

HARMOg5

YPH=CONsr·H?HI
Y=SQRT(YR··2"YTH··2+YPH··Z)

HARM096
HARM097

PYRPR=-COHST+PFIN1~

P YTPR=-CONS T'PF IN2R/51 NT HE
cYPPR=CONST' PF I "3RI SIN THE

HARHOg6
HARM Ogg
HA RM10 0

PYPR= (YR"'PY ~PR"YTH· PYTPR+YPH·PYPPRJ IV

HARt110i

PYRPT=-CONST+PFINl T
>YlPT =-CONS T' (PFI N2 TIS INT"E +H THET A'COS THE/SI NT HE)
PY PPT=C ONST' (PF I.3T lSI NTH E-HPH ":05 THE/SINTHE)

HARHt02
HARIHO J
HAR HtO ~

PYPTH= ('t'R,.PY RP T .... TH "'PY TPT "YPH. PY??T) IY
P YT PP=-CONS Tt-? FIN2P lSI NT HE

HARHi05
HARMi0G
HAR M10 7

PYPPP=CON ST" PF IN] PI SIN THE
PYPPH=' 't'R·Py RPP+'f TH "'PY TPP+ YPH· PYPPP) IY

HARH109

HARMOg~

~YRPP=-CONST·PF[N1P

HARM to 6

RETURN
HARHttO
C
COEFFICIENTS IN GAUSSIAN UNITS FROM JONES AND HELOTTE (195]).
HARM11t
:
THE FOLLOWI., 1. CARDS CAN 3E USED AS DATA CARDS FOR THIS SUBRDUTINEHARMl12
C
O.
HARHl13
C.3039
.Ol16
HARMll~
C.0t76
-.Q5Qg
-.0135
HARH115
C-.0255
.0515
-.02J6
-.00"
HARH116
C-.OH~
-.OJ97
-.0236
.a067
-.0016
HARH117
C.029]
-.0329
-.0130
.00Jl
.OOJ~
.0005
HARM118
C-.0211
-.0073
-.0( ,:7
.0210
.0017
-.OOO~
.000.
HARH119
C O.
HARH120
C
-.0555
HARM121
C
.02.0
-.00"
HARH122
C
.0190
-.0033
-.0001
HARH1ZJ
C
-.0139
.0076
.0019
.0010
HARH124
C
.0057
-.0016
.OOO~
.0032
-.OOO~
HARM1Z5
C
-.0026
-.0204
.0016
.0009
.0004
.0002
HARH126
C
THo FOLLOWING SET OF GAUSS NORMALIZED COEFFICIENTS WERE CONVERTED
HARN127
C
FROM THE SCHMIDT NORMALIZED COEFFICIENTS CALCULATED BY LINEARLY
HARH128
C
EXTRAPOLATING TO EPOCH 197. THE COoFFICIENTS PUBLISHED FOR EPOCH
H4RH129
C 19.0 BY CAIN AND SWEENEY (1970).
(USES EARTH RADIUS = 6J71.2)
HARH1JO
C .000000
HARH131
C+.30095J +.020296
HARH132
C+.028106 -.052"
-.014435
HARH1JJ
C-.0306
+.0.5;;0
-.025252 -.00'~52
HARH134
C-.041Z43 -.04395. -.01.897 +.006021 -.002525
HARH135
C+.C1'7~2 -.037076
-.016g06 +.00Z519 +.00365. +.00003.
HARH13.
C-.006713 -.01223~ -.00.3.4 +.02137
+.001593 -.000072 +.00066
HARM137
C .000000
HARH138
C .000000 -.05788.
HARH139
C .0UOOOO +.OJ59.2 +.001129
HARH140
C .000000 +.01106~ -.004421 +.001180
HARH141
C .000000 -.010299 +.0087g4 -.000086 +.002256
HARH14Z
C .000000 -.0036~9 -.012615 +.0076~5 +.002207 -.000326
HARH143
C .000000 +.003157 -.012670 -.009261 +.002266 -.000135 +.0002~3
HARH14~
END
HARH145-
