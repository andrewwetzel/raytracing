SUBROUTINE PLOT (X.Y.NEWI
COMMON IPLTI XMINO.XMAXO .YMrN O.YMAXn .RESET
(OMMON 1001 INT,IORdTdSdCdC(,IXdY
DATA (INITAL=11 ,IMINX= OI ,IMINY=OI ,(M AXX= 10231 .(MAXY=10231.
1 IMINXO=231,IMINYO=23J,(MAXXO=1023),IMAXYO=1023J
C

C

INITIALIZE LIBRARY PLOTTING ROUTINES
IF (INITAL.EO.OI GO TO I
INITAL=n
CALL DDINIT (l,lH I

C

C

COMPUTE SCALE FACTORS
IF (RESET.EO.O.I (,0 TO 5
RESET=O.
XSCALE=(MAXXC-MINXQI/(XMAXO-XMINOJ
YSCALE={MAXYO-MINYOI/CYMAXO-YMINO'
XMIN =XMINO-IMINXQ- MJNXJ/XSCALE
YMIN=YMINO-IMINYO-MINYI/YSCALE
XMAX=XMAXo+IMAXX-MAXXOI/XSCALE
YMAX=YMAXQ+IMAXY-MAXYOJ/YSCALE

C

C

STA~T A NEW LINE
5 IF (NEW.EO.OI GO TO 10
IX=MINXQ+IX-XMIN OI*XSCA LE
IYzMINYO+(Y - YMINOJ*VSCALE
IF CIX .GE.MINX.ANO.IX.LE.MAXX .ANO.I Y. GE.MINY.AND.IY.LE .MAXYI
I CALL DDBP
GO TO 50

C

C

C

C

C

HORIZONTAL DISPLACEMENT
10 XS=X-XOLD
YS=Y-YOLD
IF (XSI llt12,16
NEGATIVE
II XI=XMAX
X2=XMIN
GO TO 20
ZERO
12 IF CYSI 13,50,14
13 SI=(YMAX -YOLDI /ys
S2=(YMIN-YOLDI/yS
GO TO 40
14 SI=(YMIN-YOLOI/yS
S2=IYMAX-YOLDI/YS
GO TO 4"
POSITIVE
16 XI=XMIN
X2=XMAX

C

C
C

C

(

VERTICAL DISPLACEMENT
20 IF IYS) 21-22,26
NEGATIVE
21 Y!=YMAX
Y2=YMIN
G6 TO 30
ZERO
72 S I=( XI - XO LOI/ XS
S2 =I X2-XOLOJ/XS
GO TO 40
POSITIVE
26 Y1=YM;!N
Y2 =YMAX

C

':10 Sl=AM;AXli {X1-XOLDI/XS,IYI-YOLD)/YSI
S2=AMI N1 ( I X2-XOLD I IXS, (V2- YOLD) IYS J

86

PLOTOO I
PLOT002
PLOT003
PLOT004
PLOT005
PLOT006
PLOT007
PLOT008
PLOT009
PLOTOIO
PLOTO II
PLOTOl2
PLOT Ol3
PLOTOl4
PLOTOl5
PLOTOl6
PLOTOl7
PLOTOl8
PLOTOl9
PLOT020
PLOT021
PLOTO 2 2
PLOT023
PLOT024
PLOT025
PLOT026
PLOT027
PLOT028
PLOT029
PLOT030
PLOT031
PLOT032
PLOT033
PL OT034
PLOT035
PLOT036
PLOT037
PLOT038
PLOT039
PLOT 040
PLOT041
PLOT042
PLOT043
PLOT044
PLOT045
PLOT046
PLOT047
PLOT048
PLOT049
PLOT050
PLOT051
PLOT052
PLOT053
PLOT054
PLOT055
PLOTO 56
PLOT057
PLOT058
PLOT059
PLOT06 0
PL OT061
PLOT062
PLOT063
PLOT064
PLOT065

C
C

PLOT LINE -- CHECKING FOR BORDER CROSSINGS
40 S=SQRTIX5**2+YS**21
IF {S2.LT.O •• OR.S*Sl-S.GT.O.1 GO TO 50
IF

C

(S1_lT.a.1

Gf') TO 42

PREVIOUS POINT OFF GRAPH
IX=MINXO+(XOLD+XS*Sl-XMINO'*XSCALE+O.S
IY=MI NY O+IYOLD+YS*Sl-YMI N01*YSCALE+n.5
CALL DDBP
42 IF (S*S2-S.GT.O.1 GO TO 44
CIJRREN T POINT OFF GRAPH
IX =MINXQ+(XOLD+XS* S2 -X MIN01*XSCAlE+O.S
IY=MINYO+(YOLD+YS*S2-YMINo1*YSCAlE+O.5
CALL DOVC
GO Tn 50
CURRENT POINT ON GRAPH
44 IX=MINXQ+{X-XMINOI*XSCALf+O.5
IY=MINYO+(Y-YMINOI*YSCALE+O.5
CALL DOVC

C

C

C
C

EXIT ROUTINE
SO XOLD =X
YOLO=Y
RETURN

C
C

TERMINATE THE CURRENT PLOT
ENTRY PL TEND
CALL ODFR
RETURN
END

C

SUdRouTINE LA3PLT
LABEL THE CURRENT PLOT

LABPao 1

JIMENSIDN lABEL(9) ,TYPE(3)

LABPJ03

LABPOG2

COMMON IJOI INT,IOR,IT,IS,IC,ICC,IX,IY
CO~MON

ICO~STI

LARPJ04

PI,PIT2,PI02,OEGS,QUM(4)

COHMON /FLG/ NTYP,NlWWP,NEWWP,PENET,LINES,IHOP,HPUNCH
CJMHON IWW/ ID(lO)tWO,W(~OJ)
1

PLOT066
PLOT067
PLOT068
PLOT069
PLOT070
PLOT07!
PLOT072
PLOT073
PLOT074
PLOT075
PLOT076
PLOT077
PLOT07B
PLOT079
PLOTOBO
PLOTOB!
PLOTOB2
PLOT083
PLOT084
PLOTOB5
PLOT086
PLoTOB7
PLOTOBB
PLOTOB9
PLOT090
PLOT09!
PLOT092
PLOT093
PLOT094
PLOT 95-
