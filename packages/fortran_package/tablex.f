SUBROUTINE TABLEX
C
CALCULATES ELECTRON OENSITY ANO GRADIENT FROM PROFILFS HAVING
THE SAME FORM AS THOSE USED BY CROFTS RAY TRACING PROGRAM
C
C MAKES AN EXPONENTIAL EXTRAPOLATION DOWN USING THE BOTTOM TWO POINTS
C
NEEDS SUBROUTINE GAuSEL

TABXOOI
TABX002

TABX003
TABXOU4

DIMENSION HP(C250),FN2C(250)'ALPHA(250),BETA(2S0),GAMMAC250),

TABX005
TABX006

1 DFLTAf?tinl , SLOPF:f?liOI,MATI4,'i)

TA8X007

(OMMON ICONST/ PI,PIT2,PID2,DEGS,RAD.K.DUMI21
cOMMON IXX; MOOX(2).X,PXPR,PXPTH,PXPPH,PXPT,HMAX

TABX008
TABX009
COMMON R(61 /'WW/ lOtIO) ,WO,WI40QI
TABX OIO
E.QUIVALENCE (EARTHR.W(2») ,(F,W{6)) ,(READFN.WI 100) ) ,(PERT,W( 150) I
TABXOII
REAL MAT,K
TABXOl2
DATA {MOnXflJ=6HTAALEXI
TAAX013
ENTRY ELECTX
TABX014
IF fREADFN.EQ.O.l GO TO 10
TABX015
READFN=n.
TABX016
READ 1000, NOC,(HPCCJ),FN2CCII,I=1,NOCI
TABX017
1000 FORMAT (I4/(F8.2,E12.411
TABXOl8
PRINT 1200, (HPCIIl,FN2C(Ild=1,NOCI
TABX019
1200 FORMATIIHl,14X,6HHEIGHT,4X,16HELECTRON DENSITY/IIX,F20.IO,E20.101ITABX020
A=O.
TABX021
IFIFN2CCII.NE.0.1 A=ALOG CFN2C C21/FN2C C11 II CHPC C2 I-HPC CII I
TABX022
FN2CCli=K*FN2CCll
TABX023
FN2C(21=K*FN2C(Z)
TABX024
SLOPECII=A*FN2CCII
TABX025
SLOPECNOCI=O.
TABX026
NMAX=1
TABX027
DO 6 I=2,NOC
TABX028
IF CFN2CCII.GT.FN2CCNMAXII NMAX=I
TABX029
IF CI. EO. NOC I GO TO 4
TABX030
FNZC(I+l'=K*FN2C( 1+1'
TABX031
DO 3 J=1,3
TABX032
M=I+J-2
TABX033
MATIJ,ll=l.
TABX034
MATIJ,21=HPC{MI
TABX035
~AT(J,31=HPC(M)**2
TABX036
~AT(J,4)=FN2C(MJ
3
TABX037
CALL GA USEL (MAT,4,~,4,NRANKI
TABX03B
IF CNRANK.LT03 1 GO TO 60
TABX039
SLOPEII)=MAT(2,4'+Z.*MATI3,4 J *HPClt)
TABX040
400 5 J=1.2
TABX041
M=I+J-2
TABX042
MA T(J ,l) =l.
TABX043
MATIJ,Z' =HPC{MI
TABX044
MATIJ'3'=HPCCM)**Z
TABX045
MATIJ,4J=HPCCM'**3
TABX046
MAT IJ,SI=FN2C(MI
TABX047
L=J+2
TABX048
MATIL,l'=O.
TAB X049
MATIL,ZI=l.
TABX050
MA TIL,31=2.*HPCIMI
TABX051
~A T{l'41=3.*HPC{MI**2
TABX 052
5 MAT(L.SI=SLOPE(MI
TABX053
CALL ~AUSEL (MAT,4,4.5,NRANKI
TA8X054
IF (NRANK.LT.4) Go TO 60
TABXd-55
ALPHA ( I I =MAT (I, "i I
AFTA(j)=MAT(2,5J

TABXO,6
TAAX057

GAM¥A(TI=MAT(~,"i1

TABX058

6 DELTA(IJ =MAT(4,1j)

TA8XOlj9

HMAX=HPC(NMAX)
F2=F*F

TABX060
TABX061
TABX062
TABX063

PXPR=O.

TA8X064

NH=2

10 H=RCII-[ARTHR
IF CH.GE.HPCIIII 0,0 TO 12
11 NH=2
X=O.

TABX065
TABX066
TABX067

112

TABX068
T ABX06Q
TABX070
PXPR=A*X
TABX071
GO TO 50
TABX072
12 IF IH.GE.HPCINOCII GO TO 18
TABX073
NSTEP=1
TABX074
IF IH.lT.HPCINH-11 I NSTEP=-1
TABX 0 75
15 IF IHPCINH-II.lE.H.AND.H.lT.HPCINHII GO TO 16
TABX076
NH=NH+NSTEP
TABX071
GO TO 1~
TABX078
16 X=(ALPHAINH'+H*'BETAINHI+H*IGAMMA(NHI+H*OELTA{NHIIII/F 2
TABX079
PXPR= (SETA( NH) +H* (2 •• GAMMA (NH I+H* 3 .-DEL TA (NH) II IF2
TABX080
GO TO 50
TABX081
18 X=FN2CINOC'/F2
TABX082
50 IF IPERT.NE.O.I CAll ELECT}
TABX083
RETURN
T ABX084
60 PRINT 6000. I .HPC( J)
6000 FORMATI4H THE.I4.55HTH POINT IN THE ELECTRON DENSITY PHOFIlE HAS TTABX085
TABX086
lHE HEIGHT,F8.2.40H KM. WHICH IS THE SAME AS ANOTHER POINT.)
TABX087
CAll EXIT
TABX088
Line 7.o.8X064 in SUBROUTINE TABLEX on page 112 s"r.ould read :
PXPR=PXPTH=PXPPH=O .

TABX064

Line

P~IN'25

Follo'.{ing line CHAP024 in SUBROUTINE CH.Il. PX on page 116, insert the line :
CHAP0245
PXPPH=O .
Line VeHA010 in SUBROUTINE VCHAPX on pag e 111 should read :
X=PXPR=PXPTH=PxPFH=O .

VCHA010

Line DCHA014 in SUBROUTINE DCHAPT on page 119 should read :
X=PXPR=PXPTH=?XPPH=O.

DCHA014

Line LINE013 in SUBROUTINE LINEAR on page 120 should read :
X=PXPR=PXPTH=PXPPH=O .

LINEO 13

Line PARA012 in ~UBROUTINE QPARAB on page 121 should re?d :
X=P XP R=P XPTH = PXPPH =0 .

PARA012

Following line BULG038 in SUBROUTINE BULGE on page 123, insert the line :
BULG0385
PXPPH=O .
Following line EXPX014 in SUBROUTINE EXPX on page 124, insert the line :
PXPTH=PXPPH=O.
EXPX014S
The equation for the gyro frequency near the top of page 143 should r ead :

F ..
n

= FH. (R 0 I(R 0 + h»3(1 + 3 cos 2g)1/2
o

where 9 is the geomagnetic colatitude .
Line TABZ01S in SUBROUTINE TABLEZ on page 153 should r ead :
IF (READNU . EO.O . ) GO TO 10

TABZ01S

