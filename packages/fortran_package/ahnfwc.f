SUBROUTINE ~~NFWC
CALCULAToS THE REFRACTIVE INOEX ANO ITS GRAOIENT USING THE
APPLETON-HARTREE FO~.ULA -- NO FIELO, WITH COLLISIONS
~OMHON ICONSTI PI,PIT2,PIJ2,OEGS.R4DIAN,K,C,LOGTEN
:OHH ON IRINI MODRIN(3),CJLltFIELO,SPACEtKAY2,H,PHPT.PHP~,PHPTH,

NFWC014

f»HPPH, PHPOI1, 'HPKR, PHPKTH, PH? J(PH, I(PHPK, POLAR, lPOLAR,

NF WCOl5

1

2

NFWC01&
NFHC 017
NFWC018

COMMON IZlt 110DZ,Z,PZPR,PZPTH,PZPPH

NFW C019

COHMON IR(I

NFWC020

N,STEP.HODE,E1H~X,E1MIN,E2HAXtE2HINtFACT,RSTART

110110/1 10(10',1010,'''<400)

NFWC021

EQUIvALENCE (RAY,W(1}), (F,W(6»)

NFWC022

LOGICAL SPACE
REAL KR,KTH,KPH,K2
COMPLEX KAYZ,H,PHPT,PHPR,PHPTH,PHPPH,PHPOH,PHPKR,PHPKTH,PHPKPH.

NFWC023
NFWCOZ4
NFWCOZ5

KPHPK,POLAR,LPOLAR,U,I,PNPX,PNPZ.
N2,PNPR,PNPTH,PNPPH,PNPVR.PNPVTH,PNPVPH,NNP,PNPT

NFWC026
NFWCOZ7

1

2

DHA

(~OORIN:8HAPPLETON,8H-HARTREE.8H

FORMULA), (COLL:1.),

NFWC028

(FIELO = O.), (POlAR=(O.,l.» ,(LPOLAR=(O •• O.»,
(X = O.),(PXPR=O.), (PXPTH=O.), (PXPPH=O.), (PXPT=O.),

NFWCOZ9
NFWC030

3

(HJOY:1H ),

NFWCQ31

~

(Z=O.},(PZPR=O.),(PZPTH=O.),(PZPPH::rO.),

NFWC032

2

,

1

NFW C0 13

SGN
COMMON IXKI HOOX(Z),X,PXPR,PXPTH,PXPPH,PXPT,HHAX
COMHON I H I MOOy,~ ' (1&)
COHMON K,TH,P"I,KR,KTH,KPti

1

NFWC010
NFWC011
NFWC01Z

({:(O •• l.)), (ABSLIM:l.E-5) ,(PNPVR:O,),(PNPVTH:O,) ,(PNPVPH:O,)NFWC033
ENTRY RINOEX
NFWC034
OH:PITZ'l.Eo'<
NFWC035
C2 : C'C
NFWC03&
(Z=KR·KR+KTH"KTH+KPH·KPH

NFWC037

OM2:0M'OM
VR :C/OH'XR
VTH:C/O.·XTH
VPH : C/OH'KPH
CALL ELECTX
CA LL COLFRZ
U:1.-I'Z

NFWC038
NFWC039
NFWC040
NFWC041
NFHC042
NFHCQ43
NFWC044

N2=1.-X/U

NFWCO~5

PNPX=-1./(2.'U)
PNPZ:-I'X/(2,'U"2)
NNP=N2-(2,'X'PNPX+Z'PNPZ)
PNPR =PNPX'PX?R +PNPZ'PZ?R
PNPTH=PNPX'PXPTH+PNPZ'PZ'TH

NFWCQ40
NFHC047
NFWC048
NFWC049
NFWC050

PNPPH=PNPX·PXPPH+PNPZ"PZP~H

NFWC051

PNPT =PNPX'PXPt
SPACE=REAL (NZ) ,EQ.1., ANO, ABS (AIMAG (N2)).LT .ABSLIM
(AY2 : 0MZIC2'NZ
IF(RSTART.EQ.O,) GO TO 1
SCALE=SQRT(REAL(KJY2)/K2)
KR =SCALE'KR
XTH=SCALE'KTH
KPH=SCALE'KPH
CONTINUE

NFWC052
NFWC053
NFHC054
NFWCQ55
NFHC050
NFWC057
NFWC058

C·· .. • .. • .. •• CALCULATES A HAMILTJNIAN H
~:.5·(C2·KZ/0~2-N2)

C········· ANO ITS PARTIAL DERIVATIVES WITH RESPECT TO
C...... •• ..... • TIME. ~, THETA. PHI, OMEGA, !CR, KTHETA, AND KPHI.
PHPT =-PNPT
P~PR :-PNPR
PHPTH=-PNPTH
PHPPH:-PNPPH
PHPOH=-NNP/OH
PHPKR =C2/OH2'KR
PHPKTH=C2/0H2'KTH
PHPKPH=C210H2'KPH
KPHPK=NZ
RETURN
ENO

~FWC059

NFWCOoQ
NFWC061

NFWCQo2
NFWC063
NFWC064

NFHC065
NFWC066
NFWC067
NFHC068
NFHCQ69
NFWC070
NFWCQ71
NFWC072
NFWC073
NFWC074
NFWC 075-
