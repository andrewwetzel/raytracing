INPUT PARAMETER FORM FOR SUBROUTINE DOPPLER

HEIGHT

PROFILE OF dN/dt

(A perturbation to an ionospheric electron density model which calculates the time
derivative of electron density for c alculating Doppler shifts)
First card t e lls how many profile po i nt s in 14 format. The c ard s following t he first
c ard g ive t he he i ght and dN/dt of the profile points one point per card in FS . 2, E l2. 4
format. The heights must be in increasing order. Set WISt ::.1. 0 to read in a new
profile. After the c ards are read, DOPPLER will reset W151 .: 0. This subroutine
makes an exponential extrapolation down using the bottom 2 points in the profile.

112T3FTsT6171a 91~II I I~ijl~~16117: laI 19120 1 2T3141sl6171a 9110111 11211311411511611711all *01
HEIGHT

h
km

TIME DERIVATIVE OF
ELECTRON DENSITY
dN/dt
ELECTRONS/em ' /see

HEIGHT

h
km

TIME DERIVATIVE OF
ELECTRON DENSITY
dN/d t
ELECTRONS/em ' /see

,

I

,

I

, ,
,.

,
,
,

,

,

138

SUB~OUTINE

OOPPLER
COMPUTES ON/OT
FR)M PROFILES
AS THOSE USED 9r SUBROUTINE TAB LE X
C MAKES AN EXPONENTIAL ExTRAPOLATION OO~" USING THE
NEEDS SUaROUT[NE GAUSEL

OOPPOOl
THE SAME FHMOOPP002
00PP003
BOTTOH TWO POINTS
OOPPOO'
00PP005
JIM£NSION HP::(ZSQ) .FN2C(Z5Q} .Cl.LP·U(250),BETA(25(JI ,GAH'fA(Z50).
OOPPOOb
1 DElTA(ZSfU ,SlOPE(Z50) ,MArett,S)
00PP007
:OHHON ICONSTI P(,PIT2,PI02,OEGS,R"'O,K.OU~(2)
OOPPOO 6
::OHMON IXXI 1100)(2) ,XOUH,PXPR..PXPT-t,PXPPH,X,HHAX
00PP009
:OMMON R(E,) nn", Itl(10),WO,WC:o.oo)
00PP010
EQUIVALENCE (EA~THRtW(21),(F,jIf(&)lt{REAOFNtW(1511)
OOPP011
REAL HATtK
00PP012
'J ATA (HOOl(21=7HOOPPLER)
00PP013
ENTRY ELECTl
00PP01lo
IF (REAOF".EQ.'.I GO TO 10
00PP015
REAOFN=O.
OOPPOlb
,~EAO 1000, NJC,(liPC(I) ,FN2C(l) .1=l,NOC)
00PP017
IJuO FORHAT HIt/CFe.Z.ElZ.Ct')
00PP016
PRINT 1200, (HPC(IJ ,FNZC(!) ,I=l.NOCl
00PP019
JN/OT
1200 ~ORHAT(lHl,1~(,&KH£IGHTt4(,161
II 1 X. 02 .J .10. E2 O. 1J1 I 0) P P 020
A=Q.
00PP021
IF(FN2CLlI.NE.0.1 A=ALO:;(ON2C(2I1F'2C(1I)/(HPC(21-H'C(1I1
0)PP022
FN2C(1)=K'FN2C(1)
00PP023
FN2C(21=K'FN2C(21
00PP02.
SLOPE(1)=A>FN2CLL)
00PP025
SLOPE(NOC)=O.
OOP P 026
.... ,.,AX=1
00PP027
00PP026
00 6 I=2.NOC
IF (FN2C(lI.GT.FM2C(NMAX)) NM4X=I
00PP029
IF (I.E(;I.NOC) GO TO •
00PP030
FN2C(I+11=K-FN2CCI+l)
OOPP031
)0 3 Jzl,3
00PP032
'1=I+J-Z
00PP033
,' 1AT(J,l)::l.
00PP03.
MAT(J.2)=rlPC(H)
00PP035
MAT(J,3)::HPC(M)··2
00PP036
HAT(J.Iol=FN2C(M)
00PP037
3
CALL GAUSEL OUT .tt .. 3 .. ,+,NRANK)
00PP036
IF (NRANK.LT.31 GO TO 60
00PP039
SlOPE(I)::HAT(2.tt'+2. 4HAT(3,'+)·HPC(I)
OOPPO.O
'+ 00 5 J::l,Z
OOPPO.l
.1 =I+J-2
00PP042
HAT<J.lI =1.
00PP043
'1AT(J,Z)::HPC(H)
00PP044
HAT(J.3J=HPC(H,4·Z
00PP045
00PP046
MAT(J.4)=HPC(H'··3
MAT (J.51=FN2CLHI
00PP047
00PP046
L=J+2
00PP049
HAT (L .1>=0.
HAT(l.ZJ=l.
00PP050
HAT(L.31=2.·HPC(N'
00PP051
MAT(L.4'=3.·HPC(K,·4Z
OOPP052
5 ~AT(L.5)=SLOPE(H'
00PP053
CALL GAUSEL (HAT.,+,4,5 .. NRANK)
00PP054
IF (NRANK.LT.41 GO TO 60
00PP055
ALPHA(I)=KAT(1.51
00PP056
6ETA(I)=HAT<2.5)
OOP P05 7
GAMKA(I)=NAT(3.51
00PP056
6 DELTA(I)=KAT(4.51
00PP059
HHAX=AHlX1(HHlX,HPC(NHAX)1
OOPPObO
NH =2
00PP061
10 H=R(1)-EARTHR
00PP062
FZ=F·F
00PP063
IF (H.GE.HPC<111 GO TO 12
00PP06.
11 NH=2
00PP065

C
C

139

HAV ING

IF(FN2C(II.EO.0.I GO TO 50
X=FN2 C(11*EXPIA*(H-HPC(1)) I/F2

GO TO 50
12 IF (H.GE.HPC(NOCI I GO TO 18
NSTEP=1
IF

(H.lT.HPCINH-ll)

NSTEP=-l

15 IF (HP((NH-!I.LE.H.AN D.H.LT.HPCINHI) GO TO 16
NH =NH+N C;TEP
l~

DOPP066
DOPP067
DOPP068
DOPP069
DOPP070
DOPPO 71
DOPP072
DOPPO 73
DOPPO 74

DOPP075
16 X =(ALPH AINHI+H*(BF.TA{NHJ+H*(GAMMAINH)+H*OELTA(NHJ II )/F2
DOPP076
DOPP077
GO TO 50
J8 X =F N~C(NOCI/F2
DOPPO 78
<;n CONTINUE
DOPP079
RETURN
OOPPORO
f,f"I PRINT 6()l1n,
I .HPC( r I
DOPPORI
600 0 FORMAT(4H THE,T4,55HTH POINT IN THE
DN/DT
PROFILE HAS TDOPP082
lHE HEIGHT,F8.2,40H KM, WHICH IS THE SAME AS ANOTHER POINT.)
DOPP083
CALL EXIT
DOPP084
DOPP085
