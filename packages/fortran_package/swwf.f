SUBROUTINE SWWF
CALCULATES THE REFRA:TIVE INOEX AND ITS GRADIENT USING THE
SEN-WYLLER FORHULA -- WITH FIELD
NEEDS SUBROUTINE FSW AND FUNCTIONS C AN~ S.
COHHON ICONSTI PI,PIT2,PI02,OEGS,RAOIAN,K,SEA,LOGTEN
:OHHON IRI NI HOOR IN (3) ,CaLL, FI ELO, SPACE, KAY2, H, PHPT ,PHPR, PHPTH,

SWWFOOl
SWWF002
SWWF003
SWWF004
SWWf005
SWW F006

PH PP H, PHPOH, PH PKR t PHPKTH, PHPKPH. K PHPK. POLAR, LPOLAR,

SWWFOO 7

KPH=SCALE'K~H

CONTINUE
"=.5·(CZ·K2/0~2-N2)
~HPT

=-~NPT

~HPR

=-PN~R

PHPTH=-PNPTH
PHPPH=-PNPPH
PHPOH=-NN~/O~

PHPKR =CZIOHZ.KR

-C/OH.P~PVR

~HPKTH=C2/0H2'KTH-C/OH'P~~VTH

PHPKPH=CZIOHzoKPH-C/OHoPNPVPH
K~HPK=N2

1

BQNC112
BQNC 113

PNPT:PNPX·PXPT
~OLARI=SQRT(V2)·(YT2-RAO)/(2.·VOOTY·UX)

C
C
C

B~NC111

SPACE=N2.EQ.1.
GAH=(-YT2+RAO)/(2.·UX)
LPOLRI=X'SQRT(YT2)/(UX'(J+GAH))
KAYZ=OH2ICZ'NZ
IF(RSTART.EQ.O.) GO TO 3
,:ALE=SQRT(KAY2/K2)
KR =SCALE'KR
KTH=SCALE"KTH
3

BQNC10l
BQNC102
BQNC10J
BQNC104
BQNC105
BQNC106
BQNC107
BQNC108
BQNC109
BQNC110

2

SGN
SWWF008
COHMON IXXI HOOX(Z),X,PXPR,PXPTH,PXPPH,PXPT,HHAX
SHWFQ09
COMHON IYYI HOOY,Y,PYPR,PYPTH,PYPPH,YR,PYRPR,PYRPT,PYRPP,YTH,PYTPRSWWFD1D
1
,PYTPT,PYTPP,YPH,PYPPR,PYPPT,PYPPP
SWWF011
COHHO~ IZZI HOOZ,Z,PZPR,PZPTH,PZPPH
SWWF012
COHHON IRKI N,STEP,HOOE,E1HAX,E1HIN,E2HAX,E2HIN,FACT,RSTART
SWWF01J
::;OHHON R,TH,Pi,KR,KTH,KP"I
IWW/IO(10),ND,W(c.IlIJ)
swwrD14
EQUIVALENCE (RAY,W(1)),(F,W(6))
SWWF015
LOGICAL S~ACE
SWWF016
REAL KR,KTH,KPH,K2
SWWF017
CONPLEX KAY2,H,PHPT,PHPR,PHPTH,PHPPH,PHPOH,PHPKR,PHPKTH,PHPKPH,
SWWF018
1
KPHPK,POLAR~LPOLAR,I,UtRAO,O,pNpps,PNPX,PNPy,PNPZ,UX.u xz, SWNF019
2
AlPHA,BETA,GAHHA,A,B,C,TEHP1,TEMP2,TEHPJ.AlPOAL,BEPOBE,
SWWFD20
l
GAPOGA.CB2,N2H1,J2.02GA,QAL,OBET.OGAH,OAOy,OADl.OBOy,DBDl,SWWFOZ1
4
OCOY,OCOZ,OUOZ,OT10X,OT10Y,OT10Z,OT10PS,OT20X,OT20Y,DT20Z,SWWFOZ2
:;
0 fZOPS, ORA OOX, OR4 DOY, ORAOOl, DROOPS, 000 x, OOOY, OilDZ. OOOPX. SWW FOZ3

102

o

U~X,N2,PNPR,PNPTi,PNPPH,PNPYR,PNPVTH,PNPVPH,NNP,PNPT

OATA (HOORIN-SH
S£,6iN-WYLL£R,6H FORHULAI, ICOLL=1.I,
1
IFI£LO=1.I,(LPOLAR=(0.,O.II,
OC =0 • ) , (P XPR= a • ) , (PI( PT H=O • ) • ( PX PP H=Q • ) , ( P XPT= O. ) ,

~

3

I Y=0 • I , I PY PR= 0 • I , (PY PTH=O • I , I PY PP H= 0 • I , ( YR= O. I , I PYRPR=O .I ,
<0
(PYRPT=O. I, (PYRPP=O. I , (YTH=O. I, (PYTPR=O. I, (PHPT=O. I,
5
IPHPP= O. I , IYPH=O.l , I PYPPR=O. I , I PYPP T=O. I ,I PYPPP=O. I ,
•
(Z=O.I, IPZPR=O.l, (PlPTH=O.l,IPZPPH=O.I,
7
II=(O.,l.II,(ABSLIH=1.£-51
£NTRY RINO£X
OH=PITZ·1.E6"F
CZ=SEA'S£A
KZ=KRoKR+KTH"KTH+KPHoKPH
~HZ=OH·OH

SWWF037

SWHF036

~TH=SEA/O"·(T~
~PH=SEA/O"+~P~

$WWF039
SWWF040

~ALL ELECTX
CALL HAGY

SWHFO<01
SHWFO<oZ

OPV=l.+Y

SWWF043

OHY=1.-Y
CALL COLFRZ
ZZ=Z'Z

SWWFO<O<O
SWWFO<o5
SWWFO<O&

:ALL FSW(1./Z,ALP~A,OAL)

SWWF047

ALPOAL=OAL/ALPHA
CALL FSW(OMY/Z,BETA,OBETl
B£POB£=OB£T/BETA
CALL FSW(OPY/Z,GAMHA,OGA~I
DUOZ=I1.+ALPJ~L/Z I/ALPHA
UZ=U'U
UX=U-X
UPX=U+X
B=ALPHA/BETA
D30Y=B"BEP03E1 Z
OBOZ=-B'(ALPOAL-OHY'BEPOBEI/ZZ
C=ALPHA/GAHHA
OCOY=-C"GAPOGA/Z
O:OZ=-C" (ALPOlL-OPY'GAPa:;uIZZ
A=.5·(B+CI-l.
OAOY=.5·IOBOroOCOYI
OAOZ=.5·(OBOZ+OCOZI
TEHP3=11.-B"CloUZ+A"U·UPX

SWWFO<o6
SWWFO<09
SWWF050
SWWF051
SHWF05Z
SHWF053
SWWF05<o
SHWF055
SWWF05&
SWWF057
SHWF056
SWWF059
SWWF060
SWWFO&1
SWWF06Z
SHWF063
SWWFO&<O
SWWF065
SHWF066
SWWF067

IIZ=

SwWF068

GAPOGA=~GAHlGAHHA

VR··Z+VTH··Z+VPH··Z

'JOOTY=I/ R.·Y R+ \I T H+ Y T H+VPH·Y' PH
SWW F 069
YLZ=VOOTY'"Z/VZ
SWWF070
YTZ=Y"Z-rLZ
SHWFon
YZ=Y.Y
SWWF07Z
SZPSI=YTZ/YZ
SHWF073
CZPSI=YLZ/Y2
SWWF07<O
UXZ=UX'UX
SWWF075
CBZ=(C-BI"'Z
SWWF076
TEHP1=TEHP3'SZPSI
SWWF077
0T10X= A"U"SZPSI
SWWF078
OT10Y=IU'UPX'OAOY-UZ'IB"OCOY+C'OBOYII'SZPSI
SWWF079
OT10Z=(Z.·U·DUOZ·(1.-S·C+A)+A·X·OUOZ-UZ·(S·OCDZ+C·080Z)+U.UPX.OADZSWWFoeo
L I"SZPSI
SWWF061
11/lLYT! O/OPSIITEHPll
SWWF06Z
OTLOPS=2.·T£HP1/YTZ
SWWF063
TEHPZ=UZ'CBZOJX ZOCZPSI
SWWF064
OT ZOX=UX'UZ"CBZ'CZPSI
SWWF065
OTZOY=Z.·UZ·UXZ·CZPSI·(C-BI·lOCOY-OBOYI
SHWF066
OTZOZ=2.·UZ"UXZ·C2PSI·IC-BI·IOCOZ-OBOZI+Z."T£HPZ·11./U+1./UXI'OUOZSHWF067
11IYLYTl O/OPSl(T£HPZI
SHWF066
OTZOPS=-Z.·TEHPZ/YLZ
SHWFoe9

z.·

C

Siol N F 027

SWW F OZ 6
SWWFOZ9
SWWF030
SWWF031
SWWF03Z
SWWF033
SWWF03<O
SWWF035
SWWF036

vR =SEA/OH"KR

U=Z/ALPHA

C

SWWF024

SWWFOZ5
SWWFOZ&

103

RAO=RAY"CSQRT(TEHP1""2+TE~P2)

ORAOOX'(TEN?1"OT10X +.5
"OT20X )/RAO
ORAOOY=(TEHP1"OT1DY +
.5"OT20Y)/RAO
ORAOOZ=(TEH~1'OT10Z +
.;"DT20Z )/RAO
I1/YLY Tl O/DPSIlRAO)
OROOPSz(TEHP1'OT10PS+
.;"OT20PS)/RAO

C

O=2.·U·UX"Cl.+A)-TEMP1+RAD+2."A"U·X·SZPSI
000 X=-Z." U-OT 10 X+OR.AOOX+2.·A ".U·S2PSI

OODY= 2."U·UX.OAOY-DT10Y+DRAODY+2."U·S2PSr"OAOY
ODDI=2."Cl.+A)·OUDZ"CU+UX)+l."U·UX·OAOI-OT1Dl+DRAODI+2."X·SZPSI"
1

C

(A"OUOZtJ"ilAOn
(1/YLYT) O/OPSI(O)

OODPS;-OT1DPS+ORODPS+2."A"U·X/Y2
N2Ml =-2 .·X·(UX+U·~·S2PSII/O

N2=1.+N2"1
N OtOX{N)

C

PNPX =-(J X+U"A"S2PSI)" Cl .-X"DDOX/OI/O+X/O

c

N O/OYlN)

PNPY=-X·U·S2PSI/O·OAOY-.S"N2Ml/0·000Y
N O/OZ(N)

C

PNPZ= -X·(1.+A'S2P SI)/O·O~DZ - X·U·S2PSI /O·OADZ-.S· N2Hl/0 "0001

(N/YLYT)

C

D/OPSII~)

PNPPS=-X·U"AI(O"YZ)

-.5"N2Ml/0·00DPS

YLV=VOOTY/V2
IYLYT) O/OR(PSI)

C

PPsPR=YL2/Y'PYPR-(VR'PYRP~+vrH,pYTPR+VPH'PYPPR)'YLV

c

(YLYT)

J/OTHETA(PSIl

PPSPTH=YL2/Y·PYPTH-(~R·PYRPT+VTH·PYTPT+~PH·PYPPT)·YLV

(YLYT)

C

O/OPHIIPSll

~PSPPH=YL2/Y"~YPPH-(VR"PYRPP+VTH"PYTPP+VPH"PYPP~)"YL~
PNPR=PNPX"P~PR+PNPY"PYPR+PNPZ"PZPR+PN~PS"PPSPR

PNPTH=PNPX"~xpiH+PNPY·PYPTH+PNPZ·PZPTH+PNPPS·PPSPTH
PNPPH=~NPX·~XPPH+PNPY"PYP'H+PNPZ·PZPPH+PNPPS"PPSPPH

PNPVR=PNPPS"(VR'YLZ/VZ-YLV"YR)
PNPvT H= PNPPS. (V TH" YL2/ '12 - YLV'Y TH)
?N?VPH=PNPPS·(V?H"YLZ/VZ-YLV"YPH'

NNP=NZ-(Z.'X"PNPX+Y"PNPY+Z·PNPZ)
PNPT=PNPX"PXPT
POLAR=I'ITENP1-RAO)"Y'SQRT(V2)/(U'UX"IC-B)'VOOTY)
COSPSI=VOOTY/(Y'SQRT(V2))
LPOLAR=(.S"I·IC-B)·POLAR+A"COSPSI)·SQRTIS2PSI)1
1

(POLAR"(JX·(l.+.S·I·(C-B)·COSPSI"POLAR)+A"(U-X'CZPSI))
SPACE=REALlN2) • EQ. 1 .. ANO. ABS I A IHAG (N2) ). L T .ABS LIN

(AYZ =OH2/:;Z'N2
IF(RSTART.EQ.D.) GO TO 1
SCALE=SQRT(REAL(KAY2)/K2)
KR =SCALEoKR
KTH:SCAL EoKTH
<PH = SCALE'K~H

1

CONTINUE

C',······· CALCULATES A HAMILTONIAN H
H=.5"IC2"K2/0H2-N2)

C······,·· AND ITS PARTIAL DERIVATIVES WITH RESPECT TO
C········· TIHE, R, THETA, PHI, OMEGA, KR, I(THETA, AND KPHI.
~HPT =-PNPT
PHPR =-PHPR
PHPTH=- PHP TH
PHPPH=-PNPPH
~HPOH=-NN~/OM

PHPKR =C2/0HZ'KR -SEA/OH'PHPVR
PHPKTH=C2/OH2'KTH-SEA/OH'?HPVTH
~~PKPH=C2/0H2'KPH-SEA/OH'PNPVPH

KPHPK=N2
RETURN
ENO

104

SWW F090
SWWF091
SWWF092
SWWFD93
SWWF09"
SWWFD9S
SWW F D96
SWW FD97
SWWF098
SWWF D99
SWWF10D
SWWFiD1
SWWF102
SWWF103
swwn04
SWWF10S
SWWF106
SWWF107
SWWF108
SWWF109
sww F 110
SwWF 111
SWWF112
SWWF113
SWWFJt"
SWWF11S
SWWF116
SWWF117
SWWF118
SWWF 11 9
SWHF120
SWWF121
sww F 122
SWW F123
SWW F124

SWWF125
SWWF126
SWWF127
SWWFi28
S,W WFi29
sww F 13 0
SWWFi31
SW WF 132
SWWF133
SWWF13"
SWWF135
SWWFi36
SWWF137
SWW F138
SWWF139
SWWFi"O
SWWFi"1
SW WF 1"2
SWWF 1"3
SWWF 1"4
SWWF145
SWWF146
SWW F147
SWWF1"8
SWWF149
SWWF1S0
SWWF151
SWWF152
SWWF153
SWWF154-
