SUBROUTINE SHNF
CALCULATES THE REFRACTIVE INOEX ANO ITS GRAOIENT USING THE
SEN-HYLL£R FORMULA -- NO FIELO
NEEOS SUBROUTINES FGSW ANO FSW ANO FUNCTIONS C ANO S.

C
C
C

;OMMON ICONSTI PI,PITZ,PIJ2,OEGS,RADIAN,K,C,LOGTEN
COMMON IRINI MOORIN(3',COLL,FIElO,SPACE,KAY2,H,PHPT,PHPR,PHPTH,
1
PHPPH,PHPOH,PHPKR,PHPKTH,PHPKPH,KPHPK,POlAR.LPOLAR.
2

5GN

COHMON IXXI HOOX(Z),X,PXPR,PXPTH,PXPPH,PXPT,HHAX
COMHON Iyrl MOOY.Y(101
:OHHON 1111 HOOZ.Z,PZPR,~ZPTH.PZPPH

COHMON IRK! N,STEP,MODE,E1HAX,E1HIN,EZHAX,EZHIN,FACT,RSTART
COHMON R.TH,PH,KR,KTH,KPH
INWI IO(10),WO,w(~oa)
ElUIVALENCE (~AY.W(lll.(F.W(oll
LOGICAL SPACE

REAL KR,KTH,KPH,K2
:)HPLEX
1

KPHP<,POLARtLPOLA~,PNPX,PNPZ,Fl,OFtGltOG1,

2

NZ,PNPR,PNPTH,PNPPH,PNPVR,PNPVTH,PNPVPH,NNP,PNPT
OATA

1

KAY2,~,PHPT,PHPR,~HPTH.PHPPH,PHPOH,PHPKR,PHPKTH,PHPKPH,

(~OORIN=6H

SE.6~N-WYLLER.SH FORMULAI. (COLL=1.1.
(F I EL 0= 0 • ) , ( POLAR.: (0. , 1.) ) , (L POL AR= ( 0 • , 0 • ) ) ,

2

(x=o.), (PXPRz:O.', (PXPTH=O.),(PXPPH=O.), {PXPT=O.J ,

3
4

(HOOV=lH I.
(Z <0 • I. (P Z PR= 0 .J • (PZ P T H= 0 • ) • ( PZ PP H= 0 • I •

~

(A8SLIM=1.E-5),(PHP~~=O.),(PHPVTH=O.),(PNPVPH%O.)

ENTRY RINJEX

OM=PITZ·l.Eo·F
CZ=Coc
K2=KR·K~+KTH·(TH+KPH·KPH

OH2=0"'''OH
VR =C/OKoKR
vtH=C/O~oKTH
VPH=C/O~oKPH

CALL ELECTX
CALL COLFRZ

CALL FGSW(1./Z,Fl,OF1,Gl,OG1)
NZ =l.-xoGl
PNPX=-.soGl

PNPZ=.S·X·.OG1/Z··2
P~PR=PNPX·PX?R+PNPZ·PZPR

PNPTH=PHPX·PXPTH+PNPZ·PZPTH
PNPPH=PNPX·PXPPH+PNPZ·PZPPH
NNP=N2-(Z.·X·PNPX+Z·PNPZ}
PNPT=PNPX·PXPT
S PACE=RE AL (NZI • EO. .1 •• ANO. ABS (A IHAG (NZ) I. LT. ABS LIH
KAYZ=OH2ICzoNZ
IF(RSTART.El.D . I GO TO 1
SCALE=So.RT(REAL(KAYZI/KZI
KR =SCAlPKR
KTH=SCALEoKT ~

<PH=SCAlE·KPH
1

~ONTINUE

C•••• • ••• • CALCULATES A H~HILTONIAN H
H=.S"(:?·K2/0M2-N2'

C••• •• ... •• AND ITS PARTIAL DERIVATIVES WITH RESPECT TO

c ....... • .. •• TIHE, R, THETA, PHI, OHEGA, KR, KTHETA, AND KPHI.
PtiPT =-PNPT
PHPR = -PNPR
PHPTH=-PNPTH
PHPPH=-PNPPH
PHPOH=-NNP/O~

PMPKR =C2/0~Z'KR
PHPKTH=CZIOHZ'KTH
PHPKPH=CZIOHZ'KPH
KPHPK =NZ
RETURN
ENO

105

SWNFOOl
SWNF002
SWNF003
SWNF004
SWNF005
SWNFOOo
SWNF087
SWNF008
SWNFOD9
SWNF010
SWNFDl1
SWNFD1Z
SHNFD13
SWNFD14
SWNF015
SWNFD10
SWNFD17
SWNFD18
SWNFD19
SWNFOZO
SWNF021
SWNFD22
SWNFDZ3
SWN FD24
SHNFDZ5
SHNFD20
SWNF027
SWNFOZ6
SWHF029
SWNFOJO
SWHFOJl
SWNF032
SWNF03J
SWNFOJ4
SWNF035
SNNFOJ6
SNNFOJ7
SWNFOJS
SHNF039
SHNF040
SWNF041
SHNF04Z
SHNFD43
SWNF044
SWNF045
SWNF040
SWNF047
SWNF048
SWNF049
SWNFOSO
SWNFOSI
SHNFOSZ
SWNFOS3
SHNF054
SHNFOSS
SWNF05&
SWH F 05 7
SWN F 05 8
SWNFOS9
SWNFOoO
SNNFOol
SWN F OOZ
SWNFOoJ
SWN F 004
SWNFOoS
SWNF 000
SWNF067-
