SUBROUTINE RKAH
NUMERICAL INTEGRATION OF DIFFERENTIAL EQUATIONS
COHMON IR(I NN,SPACE,HOOE.E1HAX.E1HIN,EZHAX,EZHIN,FACT,RSTART
COHHON H20) .T.STEP.OYOT(ZO)
OIHENSION OELY(".20).BET(').XV(S).FV( ... 20).YU(S.20)
TYPE OOJBLE YU
IF (RSTART.E~.O.) GO TO 1000
LL=HH=1
IF (HOOE.Eo..lI HH="

ALPHA=T
E~t1:;O.O

BET(lI=BET(Z)=O.S
BET(3)=I.J
BET (")=0.0
STEP=SPACE
~=19.01270 .0
X;<HH)=T
IF (EU4IN.LE.O.l E1HIN=EUAX/SS.
IF (FACT.LE.O.) FACT=O.S
CALL HAHLTN
OJ 320 I=I.NN
FV(HM,I)=DYOT<I)
320 YU ( tiM , I ) :; '( (I)
~S TART= O.

GO TO 1001
1000 IF (HOOE.NE.lI GO TO 2000
C
RUNGE-KUTTA
C
lUJl 00 103 .. K=I, ..
00 13S0 I=1.NN
OELY(K,I)=STEP·F~(HH,I)

Z=YU(HH,I)
13S0 Y(I)=Z+BET(K)·OELY(K.I)
T=BET(K)·STEP.XV(HH)
CALL HAHLrN

00 1034 I=l.NN
103 .. FV(MH.I)=OYOT(I)
00 1039 I=I.NN

OEL=(OELY(1.I)+2.0·0ELY(2,I'+Z.O·DELY(3.t)+OELY(4,I»1&.0
1039 YU(HH+l.I'=YU(HH,I,tOEL

MM=HM+l
XV(HH)=XV(HH-ll+STEP
00 1 .. 00 I=I.NN
y(I)=YU(HH.I)
T=XV(MH)
CALL HAHL TN
IF (HOOE.EQ.l) GO TO .. 2
00 ISO I=I.NN
ISO FV (HH, I I =OYOT< Il
IF (HM.LE.3)
TO 1001

.0

C
AOAH;-~OJLTON
C
2000 00 20 .. 6 1=1. NN
OEL=STEP'(55.·FV(~.1)-59.'FV(3.1).37.·FV(2.I)-q.·FV(1.1))/2 ...

Y(I)bYU(4.I)+OEL
OELY(1.Il=Y<Il
T=XV( .. )+STEP
CALL HAHLrN
XV(S)=T
DO 20S1 1=1. NN
OEL=STEP·(9.·OYOT(I)+19.·FV( ... 1r-5.·FV(3.1)+FV(Z.I))/Z ...
YU (5, I) =YU (4, I' +0 El
20S1 HI) =YU (S,!)
CALL HAHLrN
IF (HOOE.LE.2) GO TO .. 2

88

RKAHOOI
RKAH002
RKAHOOJ
RKA HOO ..
RKAH005
RKAHOO&
RKAH007
RKAH006
RKA H009
RKAH010
RKA HOll
RKA H012
RKAH013
RKAH01"
RKAM01S
RKAM01&
RKA MOl7
RKAH016
RKA H019
RKA H020
RKAH021
RKA H022
RKAH023
RKA M02 ..
RKA M025
RKAH02&
RKAH027
RKAH026
RKAH029
RKAM030
ROH031
RKAM032
RKAHOJ3
RKAHOJ ..
RKAH035
RKA M03&
RKA H037
RKAH036
RKAHOJ9
RKA HO .. O
RKA H041
RKAHO .. 2
RKA HO .. 3
RKAHO ....
RKAMO .. S
RKA H O~&
RKAHO .. 7
RKA H046
RKAHO .. 9
RKAH050
RKAH051
RKAH052
RKAMOS3
RKAH054
RKAH055
RKAH05&
RKAH057
RKAH058
RKAH059
RKAHO&O
RKAH061
RKAH062
RKAH063
RKlH06 ..
RKAH065

c
C

ERROR ANALYSIS
SSE=O.O
DO 3033 1=1. NN
EPSIL=R·ABS(Y(I)-oELY(l.I))
IF (HOoE.EQ.3.ANo.Y(!) .NE.O.) EPSIL=EPSIL/ABS(y(I))
IF (SSE.LT.EPSILl SSE=EPSIL
3033 CONTINUE
IF (E1MAX.GT .SSE) GO TO 3035
IF (ABS(STEP).LE.E2MIN) ;;0 TO ~2
LL=HH=l

STEP=STEP·FI\::;r
GO TO 1001
3035 IF (LL.LE.l.0~.SSE.GE.El~IN.OR.E2MAX.LE.ABS(STEP))
LL= 2
~M=3
X~(2)=XV(3)

X~(3)=X~(5)

DO 5363 I:::l t N"
F'J(Z,I'=FV'(3,I)
F~(3.Il=OYOT(!)

YU(Z,I) =YJ<3,I)
531)3 YU(3,lJ =,('.)(5,1)

5TEP=2.0·STEf)
GO TO 1001

C
C

EXIT ROUTINE
42 LL=2
MM=4
)0 12 K=1.3
X~(K)=X~(K+1)

00 12 l=l.NN

F'J(K,I.:FV(K+1,I)
12 YU(K,U=YU(I(+1 , D

XV(4)=XV(S)
00 52 l=l . NN
n(4.Il=oYoT(!)

52 YU(4,I)=YU(S,I)
IF (HOOE.LE.2) RETURN
E=ABS(XV(4)-ALPHA)
IF (E.LE . EPM) GO TO 2000
EPH=E
RETURN
END

89

GO TO

~2

RKAH066
RKAH067
RKAH068
RKAH069
RKAH070
RKAH071
RKAH072
RKAH073
RKAH074
RKA H075
RKAM07c
RKA H077
RKAM078
RKAH079
RKAH080
RKAH081
RKAH082
RKAH083
RKAM084
RKA M085
RKAH08c
RKAH087
RKAH086
RKAH089
RKA H090
RKAM091
RKAH092
RKA H093
RKAH094
RKA H095
RKAH096
RKAH097
RKAH098
RKAH099
RKA H10 0
RKA H 10 1
RKAH102
RKAH103
RKA Hl04
RKAH105
RKAH10c
RKAH107
RKAH108
RKA Hl09-
