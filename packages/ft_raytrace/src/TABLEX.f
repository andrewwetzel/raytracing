      SUBROUTINE T ABLEX
      DIMENSION HPC(250),FN2C(250)
      COMMON /CONST/ PI,PIT2,PID2,DEGS,RAD,K,DUM
      COMMON /XX/ MODX(2),X,PXPR,PXPTH,PXPPH,PXPT,HMAX
      COMMON R(6) /WW/ ID(10),WQ,W(400)
      EQUIVALENCE (EARTHR,W(2)),(F,W(6)),(READFN,W(100)),(PERT,W(150))
      REAL K, FN2_INTERP
      CHARACTER*6 MODX
      DATA MODX(1) /'TABLEX'/
      ENTRY ELECTX
      IF (READFN.EQ.0.0) GO TO 10
      READFN=0.0
      READ 1000, NOC,(HPC(I),FN2C(I),I=1,NOC)
1000  FORMAT (I4/(F8.2,E12.4))
      PRINT 1200, (HPC(I),FN2C(I),I=1,NOC)
1200  FORMAT(1H1,14X,6HHEIGHT,4X,16HELECTRON DENSITY/(1X,F20.10,E20.10))
      A=0.0
      IF(FN2C(1).NE.0.0) A=ALOG(FN2C(2)/FN2C(1))/(HPC(2)-HPC(1))
      DO 7 I=1,NOC
      FN2C(I)=K*FN2C(I)
    7 CONTINUE
      NMAX=1
      DO 8 I=2,NOC
      IF (FN2C(I).GT.FN2C(NMAX)) NMAX=I
    8 CONTINUE
      HMAX=HPC(NMAX)
      F2=F*F
10    H=R(1)-EARTHR
      X=0.0
      PXPR=0.0
      PXPTH=0.0
      PXPPH=0.0
      NH=2
      IF (H.GE.HPC(1)) GO TO 12
11    NH=2
      IF(FN2C(1).EQ.0.0) GO TO 50
      X=FN2C(1)*EXP(A*(H-HPC(1)))/F2
      PXPR=A*X
      GO TO 50
12    IF (H.GE.HPC(NOC)) GO TO 18
      NSTEP=1
      IF (H.LT.HPC(NH-1)) NSTEP=-1
15    IF (HPC(NH-1).LE.H.AND.H.LT.HPC(NH)) THEN
        FN2_INTERP = FN2C(NH-1) + (H - HPC(NH-1)) *
     +   (FN2C(NH) - FN2C(NH-1)) / (HPC(NH) - HPC(NH-1))
        X = FN2_INTERP / F2
        PXPR = (FN2C(NH) - FN2C(NH-1)) / (HPC(NH) - HPC(NH-1)) / F2
        GO TO 50
      END IF
      NH=NH+NSTEP
      GO TO 15
18    X=FN2C(NOC)/F2
50    RETURN
      END